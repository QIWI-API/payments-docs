# Split Payments {#payments_split}

Split payments is a solution developed for marketplaces. Split payments provides a way to pay multiple service providers, making one charging operation from the customer's card.

To connect to split payments:

1. Contact your Support manager and request access to the solution.
2. Integrate the solution according to [Merchant registration](#split-boarding) section.

## Integration with QIWI Payment form {#use-splits-qiwi-form}

To send split payments, send in API request [Invoice](#invoice_put) a JSON-array<br/>`splits` with merchants data.

### Data format

> Example of invoice request with split payments

~~~shell
curl --location --request PUT 'https://api.qiwi.com/partner/payin/v1/sites/Obuc-02/bills/eqwptt' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer token \
--data-raw '{
    "amount": {
        "value": 3.00,
        "currency": "RUB"
    },
    "expirationDateTime": "2021-12-31T23:59:59+03:00",
    "comment": "сomment",
    "splits": [
        {
            "type": "MERCHANT_DETAILS",
            "siteUid": "Obuc-00",
            "splitAmount": {
                "value": 2.00,
                "currency": "RUB"
            },
            "orderId": "dressesforwhite",
            "comment": "платьица для Тани"
        },
        {
            "type": "MERCHANT_DETAILS",
            "siteUid": "Obuc-01",
            "splitAmount": {
                "value": 1.00,
                "currency": "RUB"
            },
            "orderId": "shoesforvalya",
            "comment": "туфельки для Вали"
        }
    ]
}
'
~~~

> Response example with invoice and split payments

~~~json
{
    "billId": "eqwptt",
    "invoiceUid": "44b2ef2a-edc6-4aed-87d3-01cf37ed2732",
    "amount": {
        "currency": "RUB",
        "value": "3.00"
    },
    "expirationDateTime": "2021-12-31T23:59:59+03:00",
    "status": {
        "value": "CREATED",
        "changedDateTime": "2021-02-05T10:21:17+03:00"
    },
    "comment": "сomment",
    "flags": [
        "TEST"
    ],
    "payUrl": "https://oplata.qiwi.com/form?invoiceUid=44b2ef2a-edc6-4aed-87d3-01cf37ed2732",
    "splits": [
        {
            "type": "MERCHANT_DETAILS",
            "siteUid": "Obuc-00",
            "splitAmount": {
                "currency": "RUB",
                "value": "2.00"
            },
            "orderId": "dressesforwhite",
            "comment": "платьица для Тани"
        },
        {
            "type": "MERCHANT_DETAILS",
            "siteUid": "Obuc-01",
            "splitAmount": {
                "currency": "RUB",
                "value": "1.00"
            },
            "orderId": "shoesforvalya",
            "comment": "туфельки для Вали"
        }
    ]
}
~~~

JSON-array `splits` format:

Name | Type | Description
----|------|-------
splits | Array | Merchants data array
-----|------|------
type | String | Data type. Always `MERCHANT_DETAILS` (merchant details)
siteUid | String | [Registered merchant ID](#split-boarding)
splitAmount | Object | Merchant reimbursement data
----|----|-----
value | Number | Amount of reimbursement
currency | String(3) | Text code of reimbursement currency, by ISO. Only `RUB` value
-----|-----|-----
orderId | String | Order number (optional)
comment | String | Comment for the order (optional)

<aside class="warning">The amount of reimbursements to merchants should be equal to the amount charged from the customer's card.</aside>

In JSON-object `splits` of the response the data on split payments and commissions are present:

Response field | Type | Description
----|------|-------
splits | Array | Array with split payments data
-----|------|------
type | String | Data type. Always `MERCHANT_DETAILS`
siteUid | String | [Registered merchant ID](#split-boarind)
splitAmount | Object | Merchant reimbursement data
----|----|-----
value | String | Amount of reimbursement
currency | String(3) | Text code of reimbursement currency, by ISO
-----|-----|-----
orderId | String | Order number
comment | String | Comment for the order

## Integration with Merchant's form {#use-splits-merchant-form}

To send split payment, send in API request [Payment](#payments) a JSON-array<br/> `paymentSplits` with merchants data.

### Data format

~~~json
{
 "paymentMethod": "...",
 "customer": "....",
 "deviceData": "...",
 "paymentSplits": [
   {
     "type":"MERCHANT_DETAILS",
     "siteUid":"shop_mst-01",
     "splitAmount": {
       "value":300.00,
       "currency":"RUB"
     },
     "orderId":"dasdad444ll4ll",
     "comment":"flowers for my girlfriend"
  },
  {
    "type":"MERCHANT_DETAILS",
    "siteUid":"shop_mst-02",
    "splitAmount": {
      "value":200.00,
      "currency":"RUB"
      },
      "orderId":"sdadada887sdDDDDd",
      "comment":"watermelon"
    }
  ]
}
~~~

> Пример ответа

~~~json
{
   "paymentId": "23",
   "billId": "autogenerated-2a8fcfab-45cb-43b9-81bd-edf65e0ef874",
   "createdDateTime": "2020-10-12T15:29:12+03:00",
   "amount": {
   "currency": "RUB",
   "value": "100.00"
},
   "capturedAmount": {
   "currency": "RUB",
   "value": "100.00"
},
   "refundedAmount": {
   "currency": "RUB",
   "value": "0.00"
},
   "paymentMethod": "..",
   "status": "..",
   "paymentCardInfo": "..",
   "paymentSplits": [
       {
          "type": "MERCHANT_DETAILS",
          "siteUid": "shop_mst-01",
          "splitAmount": {
          "currency": "RUB",
          "value": "30.00"
       },
          "splitCommissions": {
          "merchantCms": {
          "currency": "RUB",
          "value": "10.00"
       }
       },
          "orderId": "313fh1f23j13k1k",
          "comment": "i want to buy some goods"
       },
       {
          "type": "MERCHANT_DETAILS",
          "siteUid": "shop_mst-02",
          "splitAmount": {
             "currency": "RUB",
             "value": "20.00"
           },
          "splitCommissions": {
               "merchantCms": {
                   "currency": "RUB",
                   "value": "10.00"
                }
            },
          "orderId": "sdadada887sdDDDDd",
          "comment": "watermelon"
       },
       {
          "type": "MERCHANT_DETAILS",
          "siteUid": "shop_mst-03",
          "splitAmount": {
            "currency": "RUB",
            "value": "50.00"
          },
          "splitCommissions": {
            "merchantCms": {
              "currency": "RUB",
              "value": "10.00"
            }
          },
          "orderId": "dasdad444ll4ll",
          "comment": "flowers for my girlfriend"
       }
    ]
}
~~~

JSON-array `paymentSplits` format:

Name | Type | Description
----|------|-------
paymentSplits | Array | Merchants data array
-----|------|------
type | String | Data type. Always `MERCHANT_DETAILS` (merchant details)
siteUid | String | [Registered merchant ID](#split-boarding)
splitAmount | Object | Merchant reimbursement data
----|----|-----
value | Number | Amount of reimbursement
currency | String(3) | Text code of reimbursement currency, by ISO. Only `RUB` value
-----|-----|-----
orderId | String | Order number (optional)
comment | String | Comment for the order (optional)

<aside class="warning">The amount of reimbursements to merchants should be equal to the amount charged from the customer's card.</aside>

In JSON-object `paymentSplits` of the response the data on split payments and commissions are present:

Response field | Type | Description
----|------|-------
paymentSplits | Array | Array with split payments data
-----|------|------
type | String | Data type. Always `MERCHANT_DETAILS`
siteUid | String | [Registered merchant ID](#split-boarind)
splitAmount | Object | Merchant reimbursement data
----|----|-----
value | String | Amount of reimbursement
currency | String(3) | Text code of reimbursement currency, by ISO
-----|-----|-----
splitCommissions | Object | Commission data (optional)
-----|----|-----
merchantCms | Object | Commission from the merchant
----|-----|----
value | String | Amount of the commission
currency | String(3) |Text code of the commission currency, by ISO
-----|-----|-----
orderId | String | Order number
comment | String | Comment for the order

## Refunds on split payments {#split-refund}

After a successful authentication of the charging, a refund is available for the split payment transaction.

> Example of refund request

~~~http
PUT /partner/payin/v1/sites/test-01/payments/23/refunds/1 HTTP/1.1
Accept: application/json
Authorization: Bearer 5c4b25xx93aa435d9cb8cd17480356f9
Content-type: application/json
Host: api.qiwi.com

{
  "amount": {
    "value": 100.00,
    "currency": "RUB"
  },
  "refundSplits": [
  {
    "type": "MERCHANT_DETAILS",
    "siteUid": "shop_mst-01",
    "splitAmount": {
      "value": 30.00,
      "currency": "RUB"
    },
    "orderId": "sdadada887sdDDDDd",
    "comment": "watermelon"
  },
  {
    "type": "MERCHANT_DETAILS",
    "siteUid": "shop_mst-02",
    "splitAmount": {
      "value": 20.00,
      "currency": "RUB"
    },
   
    "orderId": "313fh1f23j13k1k",
    "comment": "i want to buy some goods"
  },
  {
    "type": "MERCHANT_DETAILS",
    "siteUid": "shop_mst-03",
    "splitAmount": {
      "value": 50.00,
      "currency": "RUB"
    },
    "orderId": "dasdad444ll4ll",
    "comment": "flowers for my girlfriend"
  }
  ]
}
~~~

> Example of response

~~~json
{
    "refundId": "1",
    "createdDateTime": "2020-10-12T15:32:29+03:00",
    "amount": {
        "currency": "RUB",
        "value": "100.00"
    },
    "status": {
        "value": "COMPLETED",
        "changedDateTime": "2020-10-12T15:32:30+03:00"
    },
    "refundSplits": [
        {
            "type": "MERCHANT_DETAILS",
            "siteUid": "shop_mst-02",
            "splitAmount": {
                "currency": "RUB",
                "value": "20.00"
            },
            "splitCommissions": {
                "merchantCms": {
                    "currency": "RUB",
                    "value": "10.00"
                }
            },
            "orderId": "sdadada887sdDDDDd",
            "comment": "watermelon"
        },
        {
            "type": "MERCHANT_DETAILS",
            "siteUid": "shop_mst-01",
            "splitAmount": {
                "currency": "RUB",
                "value": "30.00"
            },
            "splitCommissions": {
                "merchantCms": {
                    "currency": "RUB",
                    "value": "10.00"
                }
            },
            "orderId": "313fh1f23j13k1k",
            "comment": "i want to buy some goods"
        },
        {
            "type": "MERCHANT_DETAILS",
            "siteUid": "shop_mst-03",
            "splitAmount": {
                "currency": "RUB",
                "value": "50.00"
            },
            "splitCommissions": {
                "merchantCms": {
                    "currency": "RUB",
                    "value": "10.00"
                }
            },
            "orderId": "dasdad444ll4ll",
            "comment": "flowers for my girlfriend"
        }
    ]
}
~~~

To send split payments refund, send in API request [Refund](#refund-api) a JSON-array<br/>`refundSplits` with merchants refunds. Put the total amount of the refund and the refund amount for each merchant. Both partial and complete refund are supported. 

<aside class="warning">The amount of refunded reimbursements to merchants should be equal to the total amount of the refund.</aside>

JSON-array `refundSplits` format:

Name | Type | Description
----|------|-------
refundSplits | Array | Merchants refunds data array
-----|------|------
type | String | Data type. Always `MERCHANT_DETAILS` (merchant details)
siteUid | String | [Registered merchant ID](#split-boarding)
splitAmount | Object | Merchant reimbursement refund data
----|----|-----
value | Number | Amount of reimbursement refund
currency | String(3) | Text code of reimbursement refund currency, by ISO. Only `RUB` value
-----|-----|-----
orderId | String | Order number (optional)
comment | String | Comment for the order (optional)

In JSON-object `refundSplits` of the response the data on accepted refunds are present:

Response field | Type | Description
----|------|-------
refundSplits | Array | Array with refunds data
-----|------|------
type | String | Data type. Always `MERCHANT_DETAILS`
siteUid | String | [Registered merchant ID](#split-boarind)
splitAmount | Object | Merchant reimbursement refund data
----|----|-----
value | String | Amount of reimbursement refund
currency | String(3) | Text code of reimbursement refund currency, by ISO
-----|-----|-----
splitCommissions | Object | Commission data (optional)
-----|----|-----
merchantCms | Object | Commission from the merchant
----|-----|----
value | String | Amount of the commission
currency | String(3) |Text code of the commission currency, by ISO
-----|-----|-----
orderId | String | Order number
comment | String | Comment for the order

## Notifications on split payments and refunds {#split-operations-notification}

> Notification for a split payments

~~~json
{
    "payment": {
        "paymentId": "134d707d-fec4-4a84-93f3-781b4f8c24ac",
        "customFields": {
            "comment": "сomment"
        },
        "paymentCardInfo": {
            "issuingCountry": "643",
            "issuingBank": "Unknown",
            "paymentSystem": "VISA",
            "fundingSource": "UNKNOWN",
            "paymentSystemProduct": "Unknown"
        },
        "type": "PAYMENT",
        "createdDateTime": "2021-02-05T11:29:38+03:00",
        "status": {
            "value": "SUCCESS",
            "changedDateTime": "2021-02-05T11:29:39+03:00"
        },
        "amount": {
            "value": 3,
            "currency": "RUB"
        },
        "paymentMethod": {
            "type": "TOKEN",
            "paymentToken": "1620161e-d498-431b-b006-c52bb78c6bf2",
            "maskedPan": "425600******0003",
            "cardHolder": "CARD HOLDER",
            "cardExpireDate": "11/2022"
        },
        "customer": {
            "email": "glmgmmxr@qiwi123.com",
            "account": "sbderxuftsrt",
            "phone": "13387571067",
            "country": "yccsnnfjgthu",
            "city": "sqdvseezbpzo",
            "region": "shbvyjgspjvu"
        },
        "gatewayData": {
            "type": "ACQUIRING",
            "authCode": "181218",
            "rrn": "123"
        },
        "billId": "autogenerated-19cf2596-62a8-47f2-8721-b8791e9598d0",
        "flags": [],
        "paymentSplits": [
            {
                "type": "MERCHANT_DETAILS",
                "siteUid": "Obuc-00",
                "splitAmount": {
                    "value": 2,
                    "currency": "RUB"
                },
                "splitCommissions": {
                    "merchantCms": {
                        "value": 0.2,
                        "currency": "RUB"
                    },
                    "userCms": null
                },
                "orderId": "dressesforwhite",
                "comment": "платьица для Тани"
            },
            {
                "type": "MERCHANT_DETAILS",
                "siteUid": "Obuc-01",
                "splitAmount": {
                    "value": 1,
                    "currency": "RUB"
                },
                "splitCommissions": {
                    "merchantCms": {
                        "value": 0.02,
                        "currency": "RUB"
                    },
                    "userCms": null
                },
                "orderId": "shoesforvalya",
                "comment": "туфельки для Вали"
            }
        ]
    },
    "type": "PAYMENT",
    "version": "1"
}
~~~

> Notification for a split payments refund

~~~json
{
    "refund": {
        "refundId": "42f5ca91-965e-4cd0-bb30-3b64d9284048",
        "type": "REFUND",
        "createdDateTime": "2021-02-05T11:31:40+03:00",
        "status": {
            "value": "SUCCESS",
            "changedDateTime": "2021-02-05T11:31:40+03:00"
        },
        "amount": {
            "value": 3,
            "currency": "RUB"
        },
        "paymentMethod": {
            "type": "TOKEN",
            "paymentToken": "1620161e-d498-431b-b006-c52bb78c6bf2",
            "maskedPan": null,
            "cardHolder": null,
            "cardExpireDate": null
        },
        "customer": {
            "email": "glmgmmxr@qiwi123.com",
            "account": "sbderxuftsrt",
            "phone": "13387571067",
            "country": "yccsnnfjgthu",
            "city": "sqdvseezbpzo",
            "region": "shbvyjgspjvu"
        },
        "gatewayData": {
            "type": "ACQUIRING",
            "authCode": "181218",
            "rrn": "123"
        },
        "billId": "autogenerated-19cf2596-62a8-47f2-8721-b8791e9598d0",
        "flags": [
            "REVERSAL"
        ],
        "refundSplits": [
            {
                "type": "MERCHANT_DETAILS",
                "siteUid": "Obuc-00",
                "splitAmount": {
                    "value": 2,
                    "currency": "RUB"
                },
                "splitCommissions": {
                    "merchantCms": {
                        "value": 0,
                        "currency": "RUB"
                    },
                    "userCms": null
                },
                "orderId": "dressesforwhite",
                "comment": ""
            },
            {
                "type": "MERCHANT_DETAILS",
                "siteUid": "Obuc-01",
                "splitAmount": {
                    "value": 1,
                    "currency": "RUB"
                },
                "splitCommissions": {
                    "merchantCms": {
                        "value": 0.02,
                        "currency": "RUB"
                    },
                    "userCms": null
                },
                "orderId": "shoesforvalya",
                "comment": ""
            }
        ]
    },
    "type": "REFUND",
    "version": "1"
}
~~~

Notifications for split payments and split payment refunds are formed similarly to the API requests described above:

* The JSON-array `paymentSplits` is added to the [notification](#payment-callback) body with the `PAYMENT` type, which is used to transmit merchants' payment data. See [the array format](#use-splits-merchant-form). 
* The JSON-array `refundSplits` is added to the [notification](#refund-callback) body with the `REFUND` type, which is used to transmit refund data to the merchants. See [the format above](#split-refund).


## Merchant registration {#split-boarding}

For split payments, proceed with the following steps to register your merchant in the API for marketplaces.

### Key issue {#split-api-keys}

> Request

~~~shell
curl --location --request POST 'https://kassa.qiwi.com/api/users/edge_login' \
--header 'Content-Type: application/json' \
--data-raw '{
"username": "test@test.com",
"password": "111111111111"
}'
~~~

> Response

~~~http
HTTP/1.1 200 OK
Content-Type: application/json
Cookie: TokenTail:11w-www1-wwww1111wwww; 

{
"username": "test@test.com",
"user_uid": "1111ffff-22ss-1111-aaaa-12222weeeeeq",
"status_code": "ACTIVE",
"token_head": "kassa-11ww11ee-11ww-1",
"grants": []
}
~~~

To authorize in the API for marketplaces, send POST request to the URL:

`https://kassa.qiwi.com/api/users/edge_login`

Send the parameters in the request body:

* `username` (string) — login for your profile. It is issued on the start of the onboarding;
* `password` (string) — specified password.

In the response, there will be Bearer-token separated into two parts, for future requests.

To produce Bearer-token, concatenate values from `token_head` field in the response and Cookie `TokenTail`. In the example you will get API key: 

`kassa-11ww11ee-11ww-111w-www1-wwww1111wwww`

Obtained token is valid for a month. After a month, you must re-authorize in API.

Possible response statuses:

* 401 — wrong login-password pair;
* 200 — ОК.

### Transfer data of the merchant {#split-register-merchant}

> Request example

~~~shell
curl --location --request POST 'https://kassa.qiwi.com/edge/kassa-api/api/requests/v2' \
--header 'accept: application/json' \
--header 'Authorization: Bearer token' \
--data-raw '{
   "partner_name":"test_split",
   "partner_type_code":"FIRM",
   "workflow_code":"RU",
   "request_site":"http://split7_prod.ru",
   "request_site_name":"split7_prod",
   "request_type_code":"PAYIN_SPLIT",
   "request_inn":112121212121,
   "extras":[
      {
         "extra_code":"MARKET_SITE_ID",
         "extra_value":"split7_prod_market"
      },
      {
         "extra_code":"MARKET_CMS",
         "extra_value":"2.00"
      },
      {
         "extra_code":"MERCHANT_CMS",
         "extra_value":"4.30"
      },
      {
         "extra_code":"KPP",
         "extra_value":"112233445"
      },
      {
         "extra_code":"OPER_ACCOUNT",
         "extra_value":1122334456666678900
      },
      {
         "extra_code":"BIC",
         "extra_value":112233445666
      },
      {
         "extra_code":"CORR_ACCOUNT",
         "extra_value":1122334456666678900
      },
      {
         "extra_code":"BANK_NAME",
         "extra_value":"Сбер"
      },
      {
         "extra_code":"CHIEF_NEW",
         "extra_value":"{\"surname\": \"Иванов\", \"name\": \"Иван\",\"patronymic\": \"Иванович\", \"phone\": 79022222222}"
      },
      {
         "extra_code":"CONFIDANT_NEW",
         "extra_value":"{\"surname\": \"Иванов\", \"name\": \"Иван\",\"patronymic\": \"Иванович\", \"phone\": 79022222222}"
      }
   ]
}'
~~~

Pass the set of data for the merchant. The set is not complete and will be expanded.

Send a POST request to URL:

`https://kassa.qiwi.com/edge/kassa-api/api/requests/v2`

The value of [the API token](#split-api-keys) is indicated in the HTTP header `Authorization`, which is formed as

`Bearer "Token"`.

JSON-body request parameters:

Parameter | Type | Description
----|----|-----
partner_name | string | The name (brand) of the final merchant, Latin letters
partner_type_code | string | By default, `FIRM`
workflow_code | string | By default, `RU`
request_site | string | The URL of the site where the goods will be purchased in favor of this merchant as part of the split payments
request_site_name | string | Site name, Latin letters
request_type_code | string | By default, `PAYIN_SPLIT` for registering merchant to split payments
request_inn | number | Merchant's TIN
extras | JSON-object | An object containing all the other merchant data, the set is not final. The set of extras is strictly defined.
extras.extra_code | string | The name of the extra containing merchant data
extras.extra_value | string | Extra value

**JSON-object extras**

extra_code | Type | Description
-----|-----|------
MARKET_SITE_ID | string | Marketplace ID, which will be used in split payments
MERCHANT_CMS | string | The commission in percentages for the merchant under the contract. Rounded to two digits after the comma. 
MARKET_CMS | string | The marketplace commission in percentages. Rounded to two digits after the comma. 
KPP	| number	| PPC for end-merchant legal entities
OPER_ACCOUNT	| number	| Merchant's account
BIC	| number	| Bank identifier (BIK) of the merchant
CORR_ACCOUNT|number|	Correspondent account of the merchant
BANK_NAME	|string	| Settlement bank name for the merchant
CHIEF_NEW	| object| Company CEO personal data
----|----|-----
surname | string | Surname
name | string | Name
patronymic | string | Patronymic
phone  |number | Phone number
----|----|-----
CONFIDANT_NEW	| object	| Confidant personal data (if any)
----|----|-----
surname |string |Surname
name |string|Name
patronymic |string|Patronymic
phone |number| Phone number

> Response

~~~json
{
"request_uid": "3635e988-a79e-44bd-b6c0-50eb793b4acf",
"partner_uid": "afcf86e0-f354-4e88-9f31-0193f8f182d6"
}
~~~

You get the following data in response:

* `request_uid` (string) — Uid of the created application to connect the merchant. In the future, it is used to transfer documents on application.
* `partner_uid` (string) — Uid of the registered merchant. This Uid should be used to obtain the processing identifiers you have created.

### Transfer of documents {#marketplace-send-documents}

Next, you need to pass the package of documents of the merchant. Each document is sent in a separate request.

Send POST request to the URL:

`https://kassa.qiwi.com/edge/kassa-api/api/files/upload`

Value of [API token](#split-api-keys) is present in `Authorization` header, which is constructed as `Bearer "Token"`.

> Request to transfer document

~~~shell
curl --location --request POST 'https://kassa.qiwi.com/edge/kassa-api/api/files/upload' \
--header 'Authorization: Bearer kassa-token \
--header 'Content-Type: multipart/form-data' \
--form 'file=@your_file; type=application/pdf' \
--form 'properties={"request_uid":"c852ae0bf","file_code":"SPLIT_STATEMENT"}; type=application/json'
~~~

Request parameters are sent as `formData`:

Parameter | Parameter type | Data type | Description
----|----|-----
fileValueObject | formData | object | JSON-object with description of the document file. It includes parameters:<br/>`request_uid` — uid of the created application from [the previous response](#split-register-merchant) <br/>`file_code` — code of the document (see below the possible codes).
multipartFile | formData | file | Transferred document

Possible codes for the document:

* `SPLIT_STATEMENT` — Application for joining the offer, signed by the merchant and the marketplace;
* `CLIENT_QUESTIONNAIRE` — Merchant questionnaire (the questionnaire format is described in the ["Annex No.2 of the document"](https://static.qiwi.com/ru/doc/ishop/public-offer-ishop-new.pdf))

A list of codes will be extended in the future.

> Response example

~~~shell
"861d0207-54b3-4e3a-bcfb-6f379f329328"
~~~

You get uid of the added extra in response.

### Getting information about merchant registration status{#check-merchant-registration}

> Example of the current status of registration

~~~json
{
    "request_id": 17191,
    "request_site": "http://split7_prod.ru",
    "request_site_name": "split7_prod",
    "request_user_message": null,
    "request_manager_message": null,
    "request_inn": "112121212121",
    "request_qiwi_account": null,
    "request_type": {
        "request_type_code": "PAYIN_SPLIT",
        "request_type_name": "Подключение поставщиков по сплитам PayIn",
        "options": []
    },
    "request_status": {
        "request_status_code": "USER_WORK",
        "request_status_name": "Клиент заполняет"
    },
    "request_step": {
        "request_step_code": "PAYIN_SPLIT_START",
        "request_step_name": "Начальная заявка на подключение поставщика",
        "extras": [
            {
                "extra_code": "MARKET_SITE_ID",
                "extra_name": "Ид маркетплейса для сплитов",
                "extra_order": 100,
                "extra_is_unique": true,
                "extra_type_code": "STRING",
                "extra_values": [
                    {
                        "uid": "66ecc03c-dd16-426a-9975-a67d331dc5d0",
                        "value": "split7_prod_market"
                    }
                ]
            },
            {
                "extra_code": "MARKET_CMS",
                "extra_name": "Ставка маркетпейса для сплитов",
                "extra_order": 200,
                "extra_is_unique": true,
                "extra_type_code": "STRING",
                "extra_values": [
                    {
                        "uid": "7fc0a4bd-ee62-4157-8bd3-75d78a3617e1",
                        "value": "2.00"
                    }
                ]
            },
            {
                "extra_code": "MERCHANT_CMS",
                "extra_name": "Ставка мерчанта для сплитов",
                "extra_order": 300,
                "extra_is_unique": true,
                "extra_type_code": "STRING",
                "extra_values": [
                    {
                        "uid": "fd1b0dfa-b04d-43b1-b974-0f161ad76c21",
                        "value": "4.30"
                    }
                ]
            }
        ]
    },
    "request_flow": {
        "next_request_status_code": "USER_WORK",
        "back_request_status_code": null,
        "next_request_step_code": "PAYIN_SPLIT_DOCS",
        "back_request_step_code": null
    },
    "request_uid": "ac523fd1-ff43-46f7-9eea-295ddd22a403",
    "request_updated_dtime": 1611691165406,
     "merchant_site_external_ids": [
        "ereerertu-00"
    ],
    "merchant_uids": [
        "c9e6314a-f6dd-490d-b4c1-8ad659d3699e"
    ],
    "check_failures": []
}
~~~

To find out the current status of the merchant registration in the API, send a GET request to the URL:

`https://kassa.qiwi.comedge/kassa-api/api/requests?request_uid={application uid}`

You get the list of the registration data, the current step, and status of the application.

Field in response | Type | Description
-----|-----|------
request_id | number | Numerical ID of the application.<br/>This ID can be used to contact Support to clarify registration issues.
request_site | string | Site name that is transferred in [the request](#split-register-merchant)
request_site_name | string|	Merchant name that is sent in [the request](#split-register-merchant)
request_user_message |string|The field is not used
request_manager_message| string|	The field is not used
request_inn| string	| Merchant TIN that is sent in [the request](#split-register-merchant)
request_qiwi_account | string|	The field is not used
request_type| object	|Service data, description of the type of application.<br/>The following value is always returned<br/>`"request_type": {`<br/>`"request_type_code": "PAYIN_SPLIT",`<br/>`"request_type_name": "Подключение поставщиков`<br/>`по сплитам PayIn",`<br/>`"options": []`<br/>`}`
request_status | object	|JSON-object with information about status of the application.
-----|-----|------
request_status_code | string| Status code.<br/>Possible values:<br/>MANAGER_WORK — application pending<br/>REJECTED — application rejected<br/>ACCEPTED — application confirmed, merchant transferred to production environment
request_status_name | string |Russian name for status.
-----|-----|------
request_step | object	| The object that characterizes the current step of the application.
-----|-----|------
request_step_code |string|Service data
request_step_name | string|Service data
extras | object | List of previously transmitted data
-----|-----|------
extra_code | string | The name of the extras containing merchant data
extra_name | string |  Russian name of the extras containing merchant data
extra_order | number | Service data
extra_is_unique | bool | Service data
extra_type_code | string| Type of data for the extras
extra_values | array of objects| Extras value
-----|-----|------
uid | string | Internal ID to store this extra value
value | string | Transferred extras value
-----|-----|------
request_flow | object	| Service data 
request_uid | string	| Uid of the created application
request_updated_dtime | number	| Unix-time date of the last update of the application data and its status
merchant_site_external_ids | object	| An object containing data on the created `MerchantSiteId` in QIWI processing for the merchant. This ID does not come immediately, you need to repeat this request before receiving the ID, or REJECTED status.
merchant_uids | object	| Service data
check_failures | object	| The field is not used

To track the status of the application, check the value of the `request_status.request_status_code` field in response:

* `REJECTED` — The registration of the merchant is rejected. By `request_id` you can ask for more details in the Support.
* `ACCEPTED` — registration of the merchant was successful, it was transferred to production environment.
* `MANAGER_WORK` — merchant registration is underway, the processing ID of the merchant is in test mode.
